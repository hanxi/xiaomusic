---
title: ä½¿ç”¨cookieç™»é™†
---

# ä½¿ç”¨cookieç™»é™†

> ä½¿ç”¨ cookie ç™»å½•æ—¶ä¸è¦å†™å¡«è´¦å·å¯†ç 

## æ­¥éª¤

1. åœ¨ç”µè„‘ä¸Šä½¿ç”¨ Chrome æµè§ˆå™¨ç™»å½•å°ç±³è´¦å·å®˜ç½‘ ğŸ‘‰ <https://account.xiaomi.com/>
2. æŒ‰ `F12` æ‰“å¼€ç½‘ç»œå·¥å…·ï¼Œç‚¹å‡» `Network` æ ‡ç­¾é¡µã€‚
3. ç‚¹å‡»å·¦ä¸Šè§’å°åœ†ç‚¹ä½¿å…¶å˜çº¢è‰²ã€‚
4. æŒ‰ `F5` åˆ·æ–°é¡µé¢ã€‚
5. åœ¨è¿‡æ»¤æ¡†é‡Œè¾“å…¥ `account?` è¿‡æ»¤å‡ºä¸‹é¢çš„è¿æ¥ï¼Œç‚¹å‡»è¿æ¥æŸ¥çœ‹ `cookie` ï¼Œå¤åˆ¶å®Œæ•´çš„ `cookie` å€¼ã€‚éœ€è¦ç¡®ä¿å¤åˆ¶çš„  `cookie` ä¸­æœ‰ `userId` å’Œ `passToken` ä¸¤ä¸ªå€¼ã€‚
6. ç²˜è´´åˆ°è®¾ç½®é¡µé¢ã€‚

## æ­¥éª¤æˆªå›¾

![Image](https://gproxy.hanxi.cc/proxy/user-attachments/assets/681a027f-2007-4e2b-9dda-9046ae79c263)

<img width="758" height="166" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/b53de6d9-d4fd-4cfc-8dd3-6f8f4f63de69" />

## è¯„è®º


### è¯„è®º 1 - seryte

0.4.12ç‰ˆæœ¬æµ‹è¯•äº†ä½¿ç”¨cookieä¹Ÿæ— æ•ˆï¼Œæ˜¯ä¸æ˜¯cookieè¿˜æœªæ­£ç¡®è¯»å–ï¼Ÿ

<img width="1017" height="374" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/8556270f-b2f3-4b07-a951-656a9b76743c" />

<img width="1263" height="309" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/9bd7be41-df3d-4870-a879-66e2a3ce9575" />

---

### è¯„è®º 2 - WGKER

å±€åŸŸç½‘å†…ç”µè„‘è·å–å®Œæ•´cookieå¡«å…¥ï¼Œå¹¶ä¸”ä¹Ÿå¡«å†™è´¦æˆ·å¯†ç ï¼Œä»ç„¶æ— æ³•è·å–è®¾å¤‡ã€‚
å¯è¡Œçš„è¯è¿˜æ˜¯æ¢æˆè·³è½¬å°ç±³è´¦æˆ·æˆæƒç™»å½•çš„æ–¹å¼å§ï¼Œç±»ä¼¼å°ç±³å®˜æ–¹HAæ’ä»¶ï¼Œç›®å‰å¤ªæŠ˜è…¾äº†ã€‚

---

### è¯„è®º 3 - gdzjy

0.4.12ç™»å½•æ— æ•ˆï¼Œæ‰¾ä¸åˆ°éŸ³ç®±è®¾å¤‡ã€‚

<img width="1875" height="697" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/4d5c8bd6-fe00-4dca-b4bc-f9539f16790b" />


---

### è¯„è®º 4 - swxk521

0.4.12ä¸€æ ·ä¸è¡Œ

---

### è¯„è®º 5 - gdzjy

å‘ç°å›åˆ°æ—§ç‰ˆæœ¬ä¹Ÿæ‰¾ä¸åˆ°è®¾å¤‡äº†ï¼Œä¸çŸ¥æ˜¯ä¸æ˜¯å°ç±³æœ‰banè´¦å·çš„æœºåˆ¶ï¼Œæ—¥å¿—å¦‚ä¸‹ï¼š

<img width="1621" height="523" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/848b635d-34d2-458b-b9b8-3d382ef8a52c" />

<img width="3029" height="1256" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/06cecd23-58ca-426b-86f3-465b04515b9e" />

---

### è¯„è®º 6 - hanxi

æ–‡æ¡£æ›´æ–°äº†ï¼Œæˆªå›¾è¿˜æ²¡æ›´æ–°ï¼Œå¯ä»¥å…ˆçœ‹ã€‚

---

### è¯„è®º 7 - hanxi

ä¸‹ä¸ªç‰ˆæœ¬å¯ä»¥ä¸ç”¨å¡«è´¦å·å¯†ç ï¼Œç›®å‰0.4.12ç‰ˆæœ¬æœ‰ç‚¹bugéœ€è¦å¡«ã€‚

---

### è¯„è®º 8 - seryte

> æ–‡æ¡£æ›´æ–°äº†ï¼Œæˆªå›¾è¿˜æ²¡æ›´æ–°ï¼Œå¯ä»¥å…ˆçœ‹ã€‚

ä¹Ÿè¿˜æ˜¯ä¸è¡Œ ğŸ˜‚

<img width="1896" height="529" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/b3eb56bd-a22f-4664-848d-95ae87262528" />

<img width="983" height="769" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/1669bdf3-f5b5-4285-a5c0-d8b9d9c21cff" />

---

### è¯„è®º 9 - hanxi

éœ€è¦å¡«è´¦å·ï¼Œæˆ–è€…ç”¨æµ‹è¯•ç‰ˆæœ¬ã€‚

---

### è¯„è®º 10 - seryte

> éœ€è¦å¡«è´¦å·ï¼Œæˆ–è€…ç”¨æµ‹è¯•ç‰ˆæœ¬ã€‚

`hanxi/xiaomusic                  main                d1d275ae0e98        About an hour ago   341MB`
æµ‹è¯•ç‰ˆæœ¬èƒ½å‘ç°è®¾å¤‡ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•æ’­æ”¾æœ¬åœ°æ­Œæ›²ï¼Œæ’­æ”¾æ­Œæ›²æ—¶ä¼šå†æ¬¡ç™»å½•å¤±è´¥, ç„¶åæ²¡è¿‡2åˆ†é’Ÿï¼Œè®¾å¤‡å†æ¬¡æ¶ˆå¤±ï¼Œæ—¥å¿—å‡ºç°éœ€è¦éªŒè¯ç çš„ä¿¡æ¯

<img width="580" height="625" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/d8f4bf43-7333-4146-98b6-0e5a2335b225" />

<img width="1894" height="947" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/c075364e-9624-4a04-9486-208e246d00ac" />

<img width="1539" height="127" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/3ca27f19-f317-4f69-b723-7ea624db78ff" />

---

### è¯„è®º 11 - sam0773

å¡«å†™cookiesæ—¶å€™è¦åŠ ä¸Š_utm_data={""}å—ï¼Ÿç›´æ¥å¤åˆ¶è¿›å»ä¿å­˜æ—¶å€™ä¼šå¼¹å‡º[object object]

---

### è¯„è®º 12 - figsong

![Image](https://gproxy.hanxi.cc/proxy/user-attachments/assets/b52cb3ca-ffb2-4c85-92be-0803ebb2d252)
0.4.13ç‰ˆå•ç”¨cookiesã€cookiesåŠ ä¸Šè´¦å·å¯†ç ä¾ç„¶ä¸èƒ½å‘ç°è®¾å¤‡

---

### è¯„è®º 13 - hanxi

éœ€è¦ç¡®ä¿å¤åˆ¶çš„ cookie ä¸­æœ‰ userId å’Œ passToken ä¸¤ä¸ªå€¼ã€‚

---

### è¯„è®º 14 - hanxi

éœ€è¦ç¡®ä¿å¤åˆ¶çš„ cookie ä¸­æœ‰ userId å’Œ passToken ä¸¤ä¸ªå€¼ã€‚

---

### è¯„è®º 15 - dyz312

ä»…ä½¿ç”¨cookieæ‰¾çš„è®¾å¤‡äº†ï¼Œæ„Ÿè°¢ï¼

---

### è¯„è®º 16 - xpeagle

4.14ä¹Ÿæ˜¯æ˜¾ç¤ºä¸èƒ½æ‰¾åˆ°è®¾å¤‡ï¼Œä¸çŸ¥é“å’‹å›äº‹ï¼Œcookieä¹Ÿæ˜¯å¡«äº†çš„ï¼Œ cookie ä¸­æœ‰ userId å’Œ passToken ä¸¤ä¸ªå€¼çš„ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½æ‰¾åˆ°è®¾å¤‡å“¦

<img width="1045" height="702" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/c4cf7f46-3391-44b6-bd6b-cc6b24948857" />

---

### è¯„è®º 17 - xpeagle

> ä»…ä½¿ç”¨cookieæ‰¾çš„è®¾å¤‡äº†ï¼Œæ„Ÿè°¢ï¼

æˆ‘ä¹Ÿæ˜¯è¯•äº†ä¸‹ä»…ç”¨cookieï¼Œä½†æ˜¯è¿˜æ˜¯æ‰¾ä¸åˆ°è®¾å¤‡ï¼Œéƒé—·äº†

---

### è¯„è®º 18 - zzfca

ä½¿ç”¨ä»…cookieç™»é™†,ç»ˆäºé“¾æ¥åˆ°å°çˆ±éŸ³ç®±äº†! è°¢è°¢è°¢è°¢

---

### è¯„è®º 19 - TangTang0812

æœ‰ä¸ªé—®é¢˜å¤§æ¦‚æ’­æ”¾å‡ é¦–æ­Œåï¼Œä¼šè§¦å‘è´¦å·å®‰å…¨æœºåˆ¶ï¼Œæ§åˆ¶å°ä¼šæç¤ºâ€œéªŒè¯ç è¾“å…¥é”™è¯¯â€ï¼Œç„¶åå°±éœ€è¦å†æ¬¡å»å®˜ç½‘è¿‡ä¸‹äººæœºéªŒè¯ï¼Œå†åˆ°xiaomusicä¸­é‡æ–°é…ç½®cookieï¼Œæ˜¯ä¸æ˜¯cookieå®¹æ˜“è¢«Mi ban  å¯¼è‡´ç”Ÿå‘½å‘¨æœŸæŒ‚äº†ï¼Œæ€»çš„æ¥è¯´è¿˜æ˜¯ä¸é”™ï¼Œèƒ½æ­£å¸¸è¯†åˆ«è®¾å¤‡äº†ï¼›æ„Ÿè°¢å¤§ä½¬çš„å€¾æƒ…å¥‰çŒ® â¤
---------------------------------
ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] device_player.py:226: play. names:['å‘Šç™½æ°”çƒå‘¨æ°ä¼¦'] 1
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] device_player.py:912: cancel_group_next_timer {'981327057': <xiaomusic.device_player.XiaoMusicDevice object at 0xffff8f736780>}
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] device_player.py:897: cancel_next_timer did: 981327057
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] device_player.py:907: ä¸‹ä¸€æ›²å®šæ—¶å™¨ä¸è§äº† did: 981327057
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] device_player.py:357: cur_music å‘Šç™½æ°”çƒå‘¨æ°ä¼¦
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] music_url.py:60: get_music_url name:å‘Šç™½æ°”çƒå‘¨æ°ä¼¦
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] music_library.py:586: try get_filename. filename:music/download/å‘Šç™½æ°”çƒå‘¨æ°ä¼¦.mp3
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] music_url.py:139: _get_local_music_url local music. name:å‘Šç™½æ°”çƒå‘¨æ°ä¼¦, filename:music/download/å‘Šç™½æ°”çƒå‘¨æ°ä¼¦.mp3
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] music_url.py:162: _get_file_url filepath:music/download/å‘Šç™½æ°”çƒå‘¨æ°ä¼¦.mp3, filename:download/å‘Šç™½æ°”çƒå‘¨æ°ä¼¦.mp3
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] music_url.py:53: get_music_sec_url. name:å‘Šç™½æ°”çƒå‘¨æ°ä¼¦ url:http://192.168.6.167:58090/music/download/%E5%91%8A%E7%99%BD%E6%B0%94%E7%90%83%E5%91%A8%E6%9D%B0%E4%BC%A6.mp3 origin_url:None
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:46] [0.4.12] [INFO] device_player.py:872: group_force_stop_xiaoai Xiaomi æ™ºèƒ½éŸ³ç®± Pro ['70ba747b-af44-4e41-bc49-b9da586cf770']
1Panel-xiaomusic-1n74  | Exception on login 2340782246: {'code': 87001, 'desc': 'éªŒè¯ç è¾“å…¥é”™è¯¯', 'captchaUrl': '/pass/getCode?icodeType=login&0.754211913663798', 'type': 'manMachine'}
1Panel-xiaomusic-1n74  | Traceback (most recent call last):
1Panel-xiaomusic-1n74  |   File "/app/.venv/lib/python3.14/site-packages/miservice/miaccount.py", line 72, in login
1Panel-xiaomusic-1n74  |     raise Exception(resp)
1Panel-xiaomusic-1n74  | Exception: {'code': 87001, 'desc': 'éªŒè¯ç è¾“å…¥é”™è¯¯', 'captchaUrl': '/pass/getCode?icodeType=login&0.754211913663798', 'type': 'manMachine'}
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:47] [0.4.12] [WARNING] device_player.py:424: Execption Error https://api2.mina.mi.com/remote/ubus: Login failed
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:47] [0.4.12] [INFO] device_player.py:875: group_force_stop_xiaoai ['70ba747b-af44-4e41-bc49-b9da586cf770'] [None]
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:47] [0.4.12] [INFO] device_player.py:362: æ’­æ”¾ http://192.168.6.167:58090/music/download/%E5%91%8A%E7%99%BD%E6%B0%94%E7%90%83%E5%91%A8%E6%9D%B0%E4%BC%A6.mp31Panel-xiaomusic-1n74  | Exception on login 2340782246: {'code': 87001, 'desc': 'éªŒè¯ç è¾“å…¥é”™è¯¯', 'captchaUrl': '/pass/getCode?icodeType=login&0.38010189998178023', 'type': 'manMachine'}
1Panel-xiaomusic-1n74  | Traceback (most recent call last):
1Panel-xiaomusic-1n74  |   File "/app/.venv/lib/python3.14/site-packages/miservice/miaccount.py", line 72, in login
1Panel-xiaomusic-1n74  |     raise Exception(resp)
1Panel-xiaomusic-1n74  | Exception: {'code': 87001, 'desc': 'éªŒè¯ç è¾“å…¥é”™è¯¯', 'captchaUrl': '/pass/getCode?icodeType=login&0.38010189998178023', 'type': 'manMachine'}
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:47] [0.4.12] [ERROR] device_player.py:730: Execption Error https://api2.mina.mi.com/remote/ubus: Login failed
1Panel-xiaomusic-1n74  | Traceback (most recent call last):
1Panel-xiaomusic-1n74  |   File "/app/xiaomusic/device_player.py", line 718, in play_one_url
1Panel-xiaomusic-1n74  |     ret = await self.auth_manager.mina_service.play_by_music_url(
1Panel-xiaomusic-1n74  |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1Panel-xiaomusic-1n74  |         device_id, url, audio_id=audio_id
1Panel-xiaomusic-1n74  |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1Panel-xiaomusic-1n74  |     )
1Panel-xiaomusic-1n74  |     ^
1Panel-xiaomusic-1n74  |   File "/app/.venv/lib/python3.14/site-packages/miservice/minaservice.py", line 206, in play_by_music_url
1Panel-xiaomusic-1n74  |     return await self.ubus_request(
1Panel-xiaomusic-1n74  |            ^^^^^^^^^^^^^^^^^^^^^^^^
1Panel-xiaomusic-1n74  |     ...<4 lines>...
1Panel-xiaomusic-1n74  |     )
1Panel-xiaomusic-1n74  |     ^
1Panel-xiaomusic-1n74  |   File "/app/.venv/lib/python3.14/site-packages/miservice/minaservice.py", line 47, in ubus_request
1Panel-xiaomusic-1n74  |     result = await self.mina_request(
1Panel-xiaomusic-1n74  |              ^^^^^^^^^^^^^^^^^^^^^^^^
1Panel-xiaomusic-1n74  |     ...<2 lines>...
1Panel-xiaomusic-1n74  |     )
1Panel-xiaomusic-1n74  |     ^
1Panel-xiaomusic-1n74  |   File "/app/.venv/lib/python3.14/site-packages/miservice/minaservice.py", line 37, in mina_request
1Panel-xiaomusic-1n74  |     return await self.account.mi_request(
1Panel-xiaomusic-1n74  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1Panel-xiaomusic-1n74  |         "micoapi", "https://api2.mina.mi.com" + uri, data, headers
1Panel-xiaomusic-1n74  |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1Panel-xiaomusic-1n74  |     )
1Panel-xiaomusic-1n74  |     ^
1Panel-xiaomusic-1n74  |   File "/app/.venv/lib/python3.14/site-packages/miservice/miaccount.py", line 155, in mi_request
1Panel-xiaomusic-1n74  |     raise Exception(f"Error {url}: {resp}")
1Panel-xiaomusic-1n74  | Exception: Error https://api2.mina.mi.com/remote/ubus: Login failed
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:47] [0.4.12] [INFO] device_player.py:700: group_player_play http://192.168.6.167:58090/music/download/%E5%91%8A%E7%99%BD%E6%B0%94%E7%90%83%E5%91%A8%E6%9D%B0%E4%BC%A6.mp3 ['70ba747b-af44-4e41-bc49-b9da586cf770'] [None]
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:47] [0.4.12] [INFO] device_player.py:366: æ’­æ”¾ å‘Šç™½æ°”çƒå‘¨æ°ä¼¦ å¤±è´¥. å¤±è´¥æ¬¡æ•°: 10
1Panel-xiaomusic-1n74  | [2026-01-17 13:06:48] [0.4.12] [INFO] 192.168.6.205:2582 - "POST /playmusiclist HTTP/1.1" 200
ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
---------------------------------

<img width="1070" height="1737" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/dc119eb8-f988-4cf8-a322-452c5c6cf8ee" />


<img width="499" height="808" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/49123fe0-9a42-4595-8c6c-cf6cc06bb032" />

<img width="1357" height="1291" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/9d930d4c-36bb-45f3-8ac3-a11033027962" />

---

### è¯„è®º 20 - hanxi

@TangTang0812 æŠŠå¯¹è¯è®°å½•å…³æ‰ä¼šå¥½ä¸€ç‚¹ã€‚

---

### è¯„è®º 21 - ideajoker

<img width="2260" height="1173" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/275debe0-9058-48ad-8c6a-a3ba3eaf5105" />

<img width="1236" height="701" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/80f152fa-1b1c-4130-8a4e-c40e8cbe2ef6" />

0.4.16ç‰ˆæœ¬è¿˜æ˜¯æ— æ³•è¯†åˆ«è®¾å¤‡ã€‚

æŒ‰ç…§/issues/99.htmlé‡Œé¢çš„æ–¹æ³•è¯•äº†

1ã€å®˜ç½‘é‡æ–°ç™»é™†è¿‡äº†
2ã€å°ç±³éŸ³å“APPä¹Ÿé‡æ–°ç™»å½•è¿‡äº†
3ã€cookieä¹Ÿå¡«å…¥äº†

ç¾¤è¾‰NASé‡Œé¢ä¸çŸ¥é“æ€ä¹ˆæŠŠç½‘ç»œç”±bridgeæ”¹ä¸ºhostï¼Œè¿™ä¸ªè¿˜æ²¡è¯•ã€‚  æœ‰æ²¡æœ‰ç±»ä¼¼çš„æƒ…å†µï¼Ÿ

---

### è¯„è®º 22 - zmz163

è¯•äº†å¾ˆå¤šæ¬¡éƒ½ä¸èƒ½æŸ¥æ‰¾è®¾å¤‡ï¼Œå±€åŸŸç½‘å†…ç”µè„‘è·å–å®Œæ•´cookieå¡«å…¥ï¼Œå¹¶ä¸”ä¹Ÿå¡«å†™è´¦æˆ·å¯†ç ï¼Œä»ç„¶æ— æ³•è·å–è®¾å¤‡ã€‚

[xiaomusic (1).txt](https://github.com/user-attachments/files/24761966/xiaomusic.1.txt)

---

### è¯„è®º 23 - sam0773

å¦‚æœç”¨cookieså°±ä¸è¦å¡«å†™è´¦å·å’Œå¯†ç 













---åŸå§‹é‚®ä»¶---
å‘ä»¶äºº: ***@***.***&gt;
å‘é€æ—¶é—´: 2026å¹´1æœˆ21æ—¥(å‘¨ä¸‰) ä¸‹åˆ5:13
æ”¶ä»¶äºº: ***@***.***&gt;;
æŠ„é€: ***@***.******@***.***&gt;;
ä¸»é¢˜: Re: [hanxi/xiaomusic] ä½¿ç”¨cookieç™»é™† (Issue #688)


zmz163 left a comment (hanxi/xiaomusic#688)
 
è¯•äº†å¾ˆå¤šæ¬¡éƒ½ä¸èƒ½æŸ¥æ‰¾è®¾å¤‡ï¼Œå±€åŸŸç½‘å†…ç”µè„‘è·å–å®Œæ•´cookieå¡«å…¥ï¼Œå¹¶ä¸”ä¹Ÿå¡«å†™è´¦æˆ·å¯†ç ï¼Œä»ç„¶æ— æ³•è·å–è®¾å¤‡ã€‚
 
xiaomusic (1).txt
 
â€”
Reply to this email directly, view it on GitHub, or unsubscribe.
You are receiving this because you commented.Message ID: ***@***.***&gt;

---

### è¯„è®º 24 - zmz163

> å¦‚æœç”¨cookieså°±ä¸è¦å¡«å†™è´¦å·å’Œå¯†ç 
> [â€¦](#)

åªç”¨cookieç™»å½•ä¹Ÿä¸è¡Œ

---

### è¯„è®º 25 - w0000dy

> > å¦‚æœç”¨cookieså°±ä¸è¦å¡«å†™è´¦å·å’Œå¯†ç 
> > [â€¦](#)
> 
> åªç”¨cookieç™»å½•ä¹Ÿä¸è¡Œ

å¡«è´¦å·å¯†ç  è´¦å·åˆ«ç”¨æ‰‹æœºå·ï¼Œæˆ‘ä¸€å¼€å§‹æ‰‹æœºå·ä¸è¡Œ ä½¿ç”¨IDå· ç„¶åå»ç½‘é¡µç™»å½•éªŒè¯ åˆ·æ–°å°±æœ‰äº†ï¼Œå¯ä»¥çš„è¯ å…ˆå»ä½ dockeré…ç½®çš„configæ–‡ä»¶å¤¹ä¸‹ä¸œè¥¿éƒ½åˆ é™¤ ç™»é™†è´¦å·åå†é‡æ–°é…ç½®ä¸‹

---

### è¯„è®º 26 - zmz163

> > > å¦‚æœç”¨cookieså°±ä¸è¦å¡«å†™è´¦å·å’Œå¯†ç 
> > > [â€¦](#)
> > 
> > 
> > åªç”¨cookieç™»å½•ä¹Ÿä¸è¡Œ
> 
> å¡«è´¦å·å¯†ç  è´¦å·åˆ«ç”¨æ‰‹æœºå·ï¼Œæˆ‘ä¸€å¼€å§‹æ‰‹æœºå·ä¸è¡Œ ä½¿ç”¨IDå· ç„¶åå»ç½‘é¡µç™»å½•éªŒè¯ åˆ·æ–°å°±æœ‰äº†ï¼Œå¯ä»¥çš„è¯ å…ˆå»ä½ dockeré…ç½®çš„configæ–‡ä»¶å¤¹ä¸‹ä¸œè¥¿éƒ½åˆ é™¤ ç™»é™†è´¦å·åå†é‡æ–°é…ç½®ä¸‹

è¯•äº†å¾ˆå¤šæ¬¡ï¼Œè¿˜æ˜¯ä¸è¡Œ

---

### è¯„è®º 27 - ideajoker

<img width="1600" height="896" alt="Image" src="https://gproxy.hanxi.cc/proxy/user-attachments/assets/69ff2cb0-f09f-4390-8aee-9743ee608f6f" />
2026å¹´1æœˆ22æ—¥12:30æµ‹è¯•åé¦ˆï¼š
ç¾¤è¾‰NASï¼ŒæŠŠé¡¹ç›®dockeré…ç½®ç›®å½•configæ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹å…¨éƒ½åˆ é™¤ï¼Œ
é‡æ–°æ‹‰å–æœ€æ–°ç‰ˆæœ¬æ„å»ºä¸€ä¸‹ï¼Œå†ç™»å½•åå°ï¼Œå¯ä»¥å…ˆCtrl+F5ä¸€ä¸‹åˆ·æ–°å‡ºæ–°ç‰ˆåå°ã€‚
è´¦å·ç™»å½•é¡µé¢åˆ æ‰æ‰‹æœºå·ï¼Œæ¢æˆIDï¼Œå¯†ç ç•™ç©ºã€‚
ç„¶åä½¿ç”¨cookieç™»å½•ï¼Œä¿å­˜ä¹‹åï¼Œå°±èƒ½è¯†åˆ«åˆ°è®¾å¤‡äº†ã€‚

---

### è¯„è®º 28 - yangjianxun36

å¤§ä½¬ç°åœ¨æœ‰ä¸ªæ–°é—®é¢˜ï¼Œä¸çŸ¥é“æ˜¯æˆ‘çš„ä¸ªä¾‹è¿˜æ˜¯è®¾å¤‡é—®é¢˜ã€‚å®¶é‡Œæœ‰ä¸¤å°å°ç±³è®¾å¤‡ï¼Œä¸€å°ç±³å®¶éŸ³ç®±ï¼Œä¸€å°è§¦å±éŸ³ç®±ï¼Œéƒ½æ˜¯åˆç‰ˆã€‚ç±³å®¶éŸ³ç®±å„é¡¹åŠŸèƒ½éƒ½æ­£å¸¸ï¼ŒåŒ…æ‹¬ç”¨é£èŠ±é›ªæœˆappæ§åˆ¶æ’­æ”¾æš‚åœã€‚ä½†æ˜¯è§¦å±éŸ³ç®±æœ‰é—®é¢˜ï¼Œåœ¨ç½‘é¡µåå°æ§åˆ¶ï¼Œç‚¹å‡»æ’­æ”¾æš‚åœéƒ½å¯ä»¥æ­£å¸¸ç”¨ï¼Œä½†æ˜¯åœæ­¢çš„æ—¶å€™éŸ³ç®±æ²¡æœ‰åœæ­¢è¯­éŸ³åé¦ˆï¼ˆç±³å®¶éŸ³ç®±æ˜¯æœ‰çš„ï¼‰ï¼Œä½†æ˜¯ç”¨ç€ä¹Ÿè¿˜æ˜¯æ²¡é—®é¢˜ï¼Œç”¨é£èŠ±é›ªæœˆappå°±æœ‰é—®é¢˜äº†ï¼Œç‚¹æ’­æ”¾å¯ä»¥æ”¾æ­Œï¼Œä½†æ˜¯ä¸€ç‚¹å°±æ²¡ååº”ï¼Œè€Œä¸”ç‚¹äº†ä»¥åå†ç½‘é¡µåå°ä¹Ÿæ— æ³•æ§åˆ¶äº†ï¼Œæ’­æ”¾æ—¶é—´ä¼šå¼€å§‹ä¸€ç›´è·³ï¼Œåå°ä¸¤ä¸ªéŸ³ç®±éƒ½æ— æ³•è¢«å‘ç°ï¼Œåªèƒ½é‡å¯å®¹å™¨åæ­£å¸¸ã€‚ä½†æ˜¯ä¸€é€šè¿‡é£èŠ±é›ªæœˆæ§åˆ¶å°±ä¼šé‡å¤å‡ºç°ä¸Šé¢çš„é—®é¢˜ã€‚åªèƒ½å†æ¬¡é‡å¯å®¹å™¨

---

### è¯„è®º 29 - b2522

ç”¨è¿™ä¸ªç½‘å€çš„tokenå¯ä»¥ç™»å½•ï¼Œ é‡Œé¢çš„useridæ¢æˆè‡ªå·±çš„
https://account.xiaomi.com/fe/service/account?userId=11111&_locale=zh_CN

---

### è¯„è®º 30 - chenxixian

æˆ‘ç”¨çš„pip instalæ–¹å¼å®‰è£…å’Œæ›´æ–°xiaomusicåœ¨Macä¸Šçš„ï¼Œä¹‹å‰å¸å·å¯†ç ä¹Ÿæ˜¯æ—¶ä¸æ—¶æœ‰é—®é¢˜ï¼Œæ”¹ç”¨cookieç™»å½•ä¼šæ­£å¸¸ï¼Œä½†Macçš„IPæœ‰æ—¶ä¼šå˜ï¼Œæ‰€ä»¥åˆåŠ äº†ä¸ªå¯åŠ¨è„šæœ¬ï¼ŒIPæ²¡å˜ç›´æ¥å¯åŠ¨xiaomusicï¼ŒIPå˜äº†ä¿®æ”¹å¥½conf/setting.jsonåï¼Œå†å¯åŠ¨xiaomusicã€‚

start_xiaomusic.sh
```
#!/bin/bash

# xiaomusicå¯åŠ¨è„šæœ¬
# åŠŸèƒ½ï¼šæ£€æŸ¥IPé…ç½®ï¼Œå¦‚ä¸ä¸€è‡´åˆ™æ›´æ–°ï¼Œç„¶åå¯åŠ¨xiaomusic

# è®¾ç½®è„šæœ¬ç›®å½•
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SETTING_FILE="$SCRIPT_DIR/conf/setting.json"

# é¢œè‰²è¾“å‡º
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# æ—¥å¿—å‡½æ•°
log_info() {
    echo -e "${GREEN}[INFO]${NC} $1"
}

log_warn() {
    echo -e "${YELLOW}[WARN]${NC} $1"
}

log_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if [ ! -f "$SETTING_FILE" ]; then
    log_error "é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $SETTING_FILE"
    exit 1
fi

# è·å–å½“å‰æ— çº¿ç½‘å¡IP (en0)
get_current_ip() {
    # å°è¯•è·å–en0çš„IPv4åœ°å€
    local ip=$(ifconfig en0 2>/dev/null | grep "inet " | awk '{print $2}' | head -1)
    if [ -z "$ip" ]; then
        # å¦‚æœen0æ²¡æœ‰IPï¼Œå°è¯•å…¶ä»–ç½‘ç»œæ¥å£
        ip=$(ifconfig | grep "inet " | grep -v "127.0.0.1" | awk '{print $2}' | head -1)
    fi
    echo "$ip"
}

# è·å–é…ç½®æ–‡ä»¶ä¸­çš„hostname IP
get_config_ip() {
    local ip=$(grep '"hostname"' "$SETTING_FILE" | sed 's/.*"hostname": *"http:\/\///' | sed 's/".*//' | tr -d ' ')
    echo "$ip"
}

# æ›´æ–°é…ç½®æ–‡ä»¶ä¸­çš„IP
update_config_ip() {
    local new_ip="$1"
    log_info "æ›´æ–°é…ç½®æ–‡ä»¶ä¸­çš„IPä¸º: $new_ip"

    # ä½¿ç”¨Pythonæ¥æ›´æ–°JSONæ–‡ä»¶ï¼Œæ›´å¯é 
    python3 -c "
import json
import sys

try:
    with open('$SETTING_FILE', 'r', encoding='utf-8') as f:
        data = json.load(f)

    data['hostname'] = 'http://$new_ip'

    with open('$SETTING_FILE', 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print('æ›´æ–°æˆåŠŸ')
except Exception as e:
    print(f'æ›´æ–°å¤±è´¥: {e}')
    sys.exit(1)
"

    if [ $? -eq 0 ]; then
        log_info "IPé…ç½®æ›´æ–°æˆåŠŸ"
        return 0
    else
        log_error "IPé…ç½®æ›´æ–°å¤±è´¥"
        return 1
    fi
}

# å¯åŠ¨xiaomusic
start_xiaomusic() {
    log_info "å¯åŠ¨xiaomusic..."

    # æ£€æŸ¥xiaomusicå‘½ä»¤æ˜¯å¦å­˜åœ¨
    if ! command -v xiaomusic &> /dev/null; then
        log_error "æœªæ‰¾åˆ°xiaomusicå‘½ä»¤ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®å®‰è£…"
        exit 1
    fi

    # è·å–xiaomusicå‘½ä»¤è·¯å¾„
    local xiaomusic_cmd=$(command -v xiaomusic)
    log_info "xiaomusicå‘½ä»¤: $xiaomusic_cmd"
    log_info "é…ç½®æ–‡ä»¶: $SETTING_FILE"

    # åˆ‡æ¢åˆ°è„šæœ¬ç›®å½•å¹¶å¯åŠ¨
    cd "$SCRIPT_DIR" || exit 1

    # æ‰§è¡Œxiaomusicå‘½ä»¤
    exec xiaomusic
}

# ä¸»ç¨‹åº
main() {
    log_info "=== xiaomusicå¯åŠ¨è„šæœ¬ ==="

    # è·å–å½“å‰IP
    current_ip=$(get_current_ip)
    if [ -z "$current_ip" ]; then
        log_error "æ— æ³•è·å–å½“å‰IPåœ°å€"
        exit 1
    fi
    log_info "å½“å‰IPåœ°å€: $current_ip"

    # è·å–é…ç½®æ–‡ä»¶ä¸­çš„IP
    config_ip=$(get_config_ip)
    if [ -z "$config_ip" ]; then
        log_error "æ— æ³•ä»é…ç½®æ–‡ä»¶ä¸­è·å–hostname IP"
        exit 1
    fi
    log_info "é…ç½®æ–‡ä»¶IP: $config_ip"

    # æ¯”è¾ƒIP
    if [ "$current_ip" = "$config_ip" ]; then
        log_info "IPé…ç½®ä¸€è‡´ï¼Œç›´æ¥å¯åŠ¨xiaomusic"
    else
        log_warn "IPé…ç½®ä¸ä¸€è‡´ï¼Œéœ€è¦æ›´æ–°é…ç½®"
        if ! update_config_ip "$current_ip"; then
            log_error "æ›´æ–°IPé…ç½®å¤±è´¥"
            exit 1
        fi
    fi

    # å¯åŠ¨xiaomusic
    start_xiaomusic
}

# æ•è·ä¸­æ–­ä¿¡å·
trap 'log_info "è„šæœ¬è¢«ä¸­æ–­"; exit 130' INT TERM

# æ‰§è¡Œä¸»ç¨‹åº
main "$@"
```

---

### è¯„è®º 31 - zhagn4

> ç”¨è¿™ä¸ªç½‘å€çš„tokenå¯ä»¥ç™»å½•ï¼Œ é‡Œé¢çš„useridæ¢æˆè‡ªå·±çš„ https://account.xiaomi.com/fe/service/account?userId=11111&_locale=zh_CN

äº²æµ‹å¯ç”¨ï¼Œè°¢è°¢

---

### è¯„è®º 32 - zhagn4

> > ç”¨è¿™ä¸ªç½‘å€çš„tokenå¯ä»¥ç™»å½•ï¼Œ é‡Œé¢çš„useridæ¢æˆè‡ªå·±çš„ https://account.xiaomi.com/fe/service/account?userId=11111&_locale=zh_CN
> 
> äº²æµ‹å¯ç”¨ï¼Œè°¢è°¢
 
å¯ç”¨ä¸€å¤©åï¼Œå¤±æ•ˆ



---

### è¯„è®º 33 - b2522

> > > ç”¨è¿™ä¸ªç½‘å€çš„tokenå¯ä»¥ç™»å½•ï¼Œ é‡Œé¢çš„useridæ¢æˆè‡ªå·±çš„ https://account.xiaomi.com/fe/service/account?userId=11111&_locale=zh_CN
> > 
> > 
> > äº²æµ‹å¯ç”¨ï¼Œè°¢è°¢
> 
> å¯ç”¨ä¸€å¤©åï¼Œå¤±æ•ˆ

é‡å¯ä¸€ä¸‹å®¹å™¨~å¦‚æœä¸è¡Œï¼Œå°±æ›´æ–°ä¸‹ckï¼Œå†é‡å¯ä¸‹å®¹å™¨

---

### è¯„è®º 34 - zhagn4

> > > > ç”¨è¿™ä¸ªç½‘å€çš„tokenå¯ä»¥ç™»å½•ï¼Œ é‡Œé¢çš„useridæ¢æˆè‡ªå·±çš„ https://account.xiaomi.com/fe/service/account?userId=11111&_locale=zh_CN
> > > 
> > > 
> > > äº²æµ‹å¯ç”¨ï¼Œè°¢è°¢
> > 
> > 
> > å¯ç”¨ä¸€å¤©åï¼Œå¤±æ•ˆ
> 
> é‡å¯ä¸€ä¸‹å®¹å™¨~å¦‚æœä¸è¡Œï¼Œå°±æ›´æ–°ä¸‹ckï¼Œå†é‡å¯ä¸‹å®¹å™¨

é‡å¯å¯ä»¥äº†ï¼Œä½†ä»Šå¤©åˆä¸è¡Œäº†ï¼Œæˆ‘è®©å®¹å™¨æ¯å¤©å®šæ—¶é‡å¯è¯•è¯•

---

### è¯„è®º 35 - ideajoker

> > > > > ç”¨è¿™ä¸ªç½‘å€çš„tokenå¯ä»¥ç™»å½•ï¼Œ é‡Œé¢çš„useridæ¢æˆè‡ªå·±çš„ https://account.xiaomi.com/fe/service/account?userId=11111&_locale=zh_CN
> > > > 
> > > > 
> > > > äº²æµ‹å¯ç”¨ï¼Œè°¢è°¢
> > > 
> > > 
> > > å¯ç”¨ä¸€å¤©åï¼Œå¤±æ•ˆ
> > 
> > 
> > é‡å¯ä¸€ä¸‹å®¹å™¨~å¦‚æœä¸è¡Œï¼Œå°±æ›´æ–°ä¸‹ckï¼Œå†é‡å¯ä¸‹å®¹å™¨
> 
> é‡å¯å¯ä»¥äº†ï¼Œä½†ä»Šå¤©åˆä¸è¡Œäº†ï¼Œæˆ‘è®©å®¹å™¨æ¯å¤©å®šæ—¶é‡å¯è¯•è¯•

æˆ‘ç°åœ¨ä¹Ÿæ˜¯æ¯å¤©å®šæ—¶é‡å¯æ‰è¡Œï¼Œæ‰¾ä¸åˆ°è§„å¾‹å•¥æ—¶å€™å°±æ‰äº†ç™»å½•ã€‚ã€‚ã€‚

---
[é“¾æ¥åˆ° GitHub Issue](https://github.com/hanxi/xiaomusic/issues/688)
